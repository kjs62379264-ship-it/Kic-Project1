{% extends "base.html" %}
{% block page_content %}
<div class="card" style="grid-column: 1 / -1;">
    <div class="card-header">
        <span>ğŸ’° {{ year }}ë…„ {{ month }}ì›” ê¸‰ì—¬ ëŒ€ì¥</span>
        
        <div style="display: inline-block;">
            {% if is_calculated %}
            <a href="{{ url_for('download_salary_excel', year=year, month=month) }}" class="btn sub-action-btn" style="background-color: #27ae60; color: white; margin-right: 10px;">
                ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
            </a>
            {% endif %}

            {% if not is_calculated %}
            <form action="{{ url_for('calculate_all_salary') }}" method="POST" style="display:inline;">
                <button type="submit" class="btn main-action-btn">âš¡ ì¼ê´„ ê³„ì‚° ë° ëŒ€ì¥ ìƒì„±</button>
            </form>
            {% else %}
            <form action="{{ url_for('calculate_all_salary') }}" method="POST" style="display:inline;" onsubmit="return confirm('ì´ë¯¸ ìƒì„±ëœ ëŒ€ì¥ì´ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ê³„ì‚°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                <button type="submit" class="btn sub-action-btn">ğŸ”„ ì¬ê³„ì‚°</button>
            </form>
            {% endif %}
        </div>
    </div>
    <div class="card-body">
        <table class="employee-table">
            <thead>
                <tr>
                    <th>ì‚¬ë²ˆ</th><th>ì´ë¦„</th><th>ë¶€ì„œ</th>
                    <th>ê¸°ë³¸ê¸‰</th><th>ìˆ˜ë‹¹</th><th>ê³µì œì´ì•¡</th>
                    <th>ì‹¤ìˆ˜ë ¹ì•¡</th><th>ì§€ê¸‰ì¼</th>
                </tr>
            </thead>
            <tbody>
            {% for pay in payrolls %}
                <tr>
                    <td>{{ pay.employee_id }}</td>
                    <td>{{ pay.name }}</td>
                    <td>{{ pay.department }}</td>
                    <td>{{ pay.total_base|comma }}</td>
                    <td>{{ pay.total_allowance|comma }}</td>
                    <td style="color: #e74c3c;">{{ pay.total_deduction|comma }}</td>
                    <td style="color: #2ecc71; font-weight: bold;">{{ pay.net_salary|comma }}</td>
                    <td>{{ pay.payment_date }}</td>
                </tr>
            {% else %}
                <tr><td colspan="8" style="text-align:center; padding: 30px;">ì•„ì§ ìƒì„±ëœ ê¸‰ì—¬ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}