{% extends "base.html" %}

{% block title %}{{ target_user.name }} - ê·¼íƒœ ìƒì„¸ ì¡°íšŒ{% endblock %}
{% block page_body_class %}attendance-employee-detail{% endblock %}

{% block page_content %}

<div class="card" style="grid-column: 1 / 3; grid-row: 1 / 2;">
    <div class="card-header" style="justify-content: flex-start; gap: 20px;">
        <span style="font-size: 1.1em; font-weight: bold;">
            {{ target_user.name }} ({{ target_user.department }} / {{ target_user.id }})
        </span>
        <span style="font-size: 1.1em; color: #555;">
            ë³µë¬´ í†µê³„ ìš”ì•½
        </span>
        <a href="{{ url_for('attendance_employee') }}" class="sub-action-btn header-btn" style="margin-left: auto;">ğŸ”™ ì§ì› ëª©ë¡</a>
    </div>
    
    <div class="card-body">
        <div class="statistics-container" style="display: flex; gap: 20px;">
            
            <div class="monthly-stats" style="flex: 1 1 50%; padding-right: 15px; border-right: 1px solid #eee;">
                <h3 style="margin-top: 0; color: #3498db;">{{ employee_stats_summary.target_month }} ì‹¤ì </h3>
                <table class="employee-table stat-table">
                    <tr><th>ì§€ê° ì¼ìˆ˜</th><td>{{ employee_stats_summary.monthly.tardy_count }}íšŒ</td></tr>
                    <tr><th>ê²°ê·¼ ì¼ìˆ˜</th><td style="color: #e74c3c;">{{ employee_stats_summary.monthly.absent_count }}ì¼</td></tr>
                    
                    <tr>
                        <th>ì™¸ê·¼ / ì¶œì¥ ì¼ìˆ˜</th>
                        <td>{{ employee_stats_summary.monthly.offsite_days }}ì¼ / {{ employee_stats_summary.monthly.business_trip_days }}ì¼</td>
                    </tr>
                    
                    <tr><th>íœ´ê°€ ì‚¬ìš©</th><td style="font-weight: bold;">{{ employee_stats_summary.monthly.leave_days }}ì¼</td></tr>
                    <tr style="border-top: 2px solid #ddd;"><th>ì´ˆê³¼ ê·¼ë¬´ (ì‹œê°„)</th><td style="color: #2ecc71; font-weight: bold;">{{ employee_stats_summary.monthly.overtime_hours }}</td></tr>
                    <tr><th>ì´ˆê³¼ ê·¼ë¬´ (ì¼ìˆ˜)</th><td>{{ employee_stats_summary.monthly.overtime_days_count }}ì¼</td></tr>
                </table>
            </div>

            <div class="yearly-stats" style="flex: 1 1 50%;">
                <h3 style="margin-top: 0; color: #7f8c8d;">{{ employee_stats_summary.target_year }}ë…„ ëˆ„ì </h3>
                 <table class="employee-table stat-table">
                    <tr><th>ì§€ê° ì¼ìˆ˜</th><td>{{ employee_stats_summary.yearly.tardy_count }}íšŒ</td></tr>
                    <tr><th>ê²°ê·¼ ì¼ìˆ˜</th><td style="color: #e74c3c;">{{ employee_stats_summary.yearly.absent_count }}ì¼</td></tr>
                    
                    <tr>
                        <th>ì™¸ê·¼ / ì¶œì¥ ì¼ìˆ˜</th>
                        <td>{{ employee_stats_summary.yearly.offsite_days }}ì¼ / {{ employee_stats_summary.yearly.business_trip_days }}ì¼</td>
                    </tr>
                    
                    <tr><th>íœ´ê°€ ì‚¬ìš©</th><td style="font-weight: bold;">{{ employee_stats_summary.yearly.leave_days }}ì¼</td></tr>
                    <tr style="border-top: 2px solid #ddd;"><th>ì´ˆê³¼ ê·¼ë¬´ (ì‹œê°„)</th><td style="color: #2ecc71; font-weight: bold;">{{ employee_stats_summary.yearly.overtime_hours }}</td></tr>
                    <tr><th>ì´ˆê³¼ ê·¼ë¬´ (ì¼ìˆ˜)</th><td>{{ employee_stats_summary.yearly.overtime_days_count }}ì¼</td></tr>
                </table>
            </div>

        </div>
    </div>
</div>

<div class="card" style="grid-column: 1 / 3; grid-row: 2 / 3; height: 380px;"> 
    <div class="card-header">
        <span style="flex-grow: 1;">ğŸ—“ï¸ {{ current_month_name }} ê·¼íƒœ ë‹¬ë ¥</span>
        
        <button class="sub-action-btn calendar-nav-btn" 
                onclick="changeMonth({{ current_year }}, {{ current_month | int - 1 }})">
            &lt;
        </button>
        <button class="sub-action-btn calendar-nav-btn" 
                onclick="changeMonth({{ current_year }}, {{ current_month | int + 1 }})">
            &gt;
        </button>
    </div>
    
    <div class="card-body" style="padding: 10px;">
        <div id="attendance-calendar" style="width: 100%;">
            {{ calendar_html | safe }} 
        </div>
    </div>
</div>

{% endblock %}